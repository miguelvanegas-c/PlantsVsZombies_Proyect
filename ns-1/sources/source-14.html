


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > PVZ</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">&lt;empty package name&gt;</a>
</div>

<h1>Coverage Summary for Class: PVZ (&lt;empty package name&gt;)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">PVZ</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    83,6%
  </span>
  <span class="absValue">
    (51/61)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    88%
  </span>
  <span class="absValue">
    (139/158)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    91,9%
  </span>
  <span class="absValue">
    (260/283)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;
&nbsp;
&nbsp;import javax.swing.*;
&nbsp;import java.io.*;
&nbsp;import java.util.List;
&nbsp;import java.util.ArrayList;
&nbsp;
&nbsp;/**
&nbsp; * This is the principal class of the application, it will have the behaviors and functionalities of the whole game.
&nbsp; *
&nbsp; * @author Miguel Angel Vanegas y Julian Castiblanco.
&nbsp; * @version 1.0
&nbsp; */
&nbsp;
&nbsp;public class PVZ implements Serializable {
&nbsp;    public static final int rows = 5;
&nbsp;    public static final int columns = 10;
<b class="fc">&nbsp;    private List&lt;Element&gt;[][] board = new ArrayList[rows][columns];</b>
&nbsp;    private String[] zombiesInGame, plantsInGame;
<b class="fc">&nbsp;    private Plant[][] plantsBoard = new Plant[rows][columns];</b>
&nbsp;    private int suns,brains, zombiePoints, plantPoints;
<b class="fc">&nbsp;    private List&lt;Mover&gt; moves = new ArrayList();</b>
<b class="fc">&nbsp;    private List&lt;Attacker&gt; attackers = new ArrayList();</b>
<b class="fc">&nbsp;    private List&lt;Shooter&gt; shooters = new ArrayList();</b>
<b class="fc">&nbsp;    private List&lt;Element&gt; elements = new ArrayList();</b>
<b class="fc">&nbsp;    private List&lt;GenerateCoins&gt; generateCoins = new ArrayList();</b>
<b class="fc">&nbsp;    private boolean gameFinished = false;</b>
&nbsp;    private boolean zombieType;
&nbsp;    private boolean plantType;
&nbsp;    private GameMode gameMode;
&nbsp;    private String game;
&nbsp;    private Machine zombieMachine;
&nbsp;    private Machine plantMachine;
&nbsp;    private Timer gameTimer;
&nbsp;
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Constructor for the PVZ class MVSM game mode.
&nbsp;     *
&nbsp;     * @param plantsInGame  Array of plants available in the game.
&nbsp;     * @param zombiesInGame Array of zombies available in the game.
&nbsp;     * @param zombieType    Boolean indicating whether zombie actions are active.
&nbsp;     * @param plantType     Boolean indicating whether plant actions are active.
&nbsp;     * @param startingSuns  starting suns to the game.
&nbsp;     * @param startingBrains starting brains to the game.
&nbsp;     * @param gameTime      game time to the game.
&nbsp;     * @param hordesNumber  number of hordes to the game
&nbsp;     * @param hordesTime    hordes duration time.
&nbsp;     */
<b class="fc">&nbsp;    public PVZ(String[] plantsInGame, String[] zombiesInGame, boolean zombieType,boolean plantType,int startingSuns, int startingBrains , int gameTime , int hordesNumber, int hordesTime) {</b>
<b class="fc">&nbsp;        this.plantsInGame = plantsInGame;</b>
<b class="fc">&nbsp;        this.zombiesInGame = zombiesInGame;</b>
<b class="fc">&nbsp;        this.suns = startingSuns;</b>
<b class="fc">&nbsp;        this.brains = startingBrains;</b>
<b class="fc">&nbsp;        this.game = &quot;MvsM&quot;;</b>
<b class="fc">&nbsp;        this.zombieType = zombieType;</b>
<b class="fc">&nbsp;        this.plantType = plantType;</b>
<b class="fc">&nbsp;        startingBoards();</b>
<b class="fc">&nbsp;        generateLawnMower();</b>
<b class="fc">&nbsp;        startingGame(zombieType,plantType,gameTime,hordesNumber,hordesTime);</b>
<b class="fc">&nbsp;        gameTimer = new Timer(gameTime*1000, e -&gt; endGameTwo());</b>
<b class="fc">&nbsp;        gameTimer.start();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Constructor for the PVZ class PVSM game mode.
&nbsp;     *
&nbsp;     * @param plantsInGame  Array of plants available in the game.
&nbsp;     * @param zombiesInGame Array of zombies available in the game.
&nbsp;     * @param zombieType    Boolean indicating whether zombie actions are active.
&nbsp;     * @param startingSuns  starting suns to the game.
&nbsp;     * @param gameTime      game time to the game.
&nbsp;     * @param hordesNumber  number of hordes to the game
&nbsp;     * @param hordesTime    hordes duration time.
&nbsp;     */
&nbsp;
<b class="fc">&nbsp;    public PVZ(String[] plantsInGame, String[] zombiesInGame, boolean zombieType,int startingSuns,int startingBrains, int gameTime , int hordesNumber, int hordesTime) {</b>
<b class="fc">&nbsp;        this.plantsInGame = plantsInGame;</b>
<b class="fc">&nbsp;        this.zombiesInGame = zombiesInGame;</b>
<b class="fc">&nbsp;        this.suns = startingSuns;</b>
<b class="fc">&nbsp;        this.brains = startingBrains;</b>
<b class="fc">&nbsp;        this.game = &quot;PvsM&quot;;</b>
<b class="fc">&nbsp;        this.zombieType = zombieType;</b>
<b class="fc">&nbsp;        startingBoards();</b>
<b class="fc">&nbsp;        generateLawnMower();</b>
<b class="fc">&nbsp;        startingGame(zombieType,gameTime,hordesNumber,hordesTime);</b>
<b class="fc">&nbsp;        gameTimer = new Timer(gameTime*1000, e -&gt; endGame());</b>
<b class="fc">&nbsp;        gameTimer.start();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Constructor for the PVZ class PVSP game mode.
&nbsp;     *
&nbsp;     * @param plantsInGame  Array of plants available in the game.
&nbsp;     * @param zombiesInGame Array of zombies available in the game.
&nbsp;     * @param startingSuns  starting suns to the game.
&nbsp;     * @param startingBrains starting brains to the game.
&nbsp;     * @param gameTime      game time to the game.
&nbsp;     */
&nbsp;
<b class="fc">&nbsp;    public PVZ(String[] plantsInGame, String[] zombiesInGame,int startingSuns, int startingBrains , int gameTime) {</b>
<b class="fc">&nbsp;        this.plantsInGame = plantsInGame;</b>
<b class="fc">&nbsp;        this.zombiesInGame = zombiesInGame;</b>
<b class="fc">&nbsp;        this.suns = startingSuns;</b>
<b class="fc">&nbsp;        this.brains = startingBrains;</b>
<b class="fc">&nbsp;        this.game = &quot;PvsP&quot;;</b>
<b class="fc">&nbsp;        startingBoards();</b>
<b class="fc">&nbsp;        generateLawnMower();</b>
<b class="fc">&nbsp;        startingGame(gameTime);</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * start game to the PvsM gameMode.
&nbsp;     * @param pvz, the game.
&nbsp;     * @param zombieType, the zombie machine to the game.
&nbsp;     * @param gameTime, the gameTime of the game
&nbsp;     * @param hordesNumber, number of hordes.
&nbsp;     * @param hordesTime, hordes duration time.
&nbsp;     */
&nbsp;    private void startingGame( boolean zombieType, int gameTime, int hordesNumber, int hordesTime) {
<b class="fc">&nbsp;        gameMode = new PvsM(zombieType,gameTime, hordesNumber, hordesTime, this);</b>
<b class="pc">&nbsp;        zombieMachine = (zombieType)? new ZombieOriginal(this):new ZombieStrategic(this);</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * start game to the MvsM gameMode.
&nbsp;     * @param pvz, the game.
&nbsp;     * @param zombieType, the zombie machine to the game.
&nbsp;     * @param plantType, the plant machine to the game.
&nbsp;     * @param gameTime, the gameTime of the game.
&nbsp;     * @param hordesNumber, number of hordes.
&nbsp;     * @param hordesTime, hordes duration time.
&nbsp;     */
&nbsp;    private void startingGame( boolean zombieType, boolean plantType,int gameTime, int hordesNumber, int hordesTime) {
<b class="fc">&nbsp;        gameMode = new MvsM(zombieType,gameTime, hordesNumber, hordesTime,this);</b>
<b class="pc">&nbsp;        zombieMachine = (zombieType)? new ZombieOriginal(this):new ZombieStrategic(this);</b>
<b class="pc">&nbsp;        plantMachine = (plantType) ? new PlantIntelligent(this):new PlantsStrategic(this);</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * start game to the PvsP gameMode.
&nbsp;     * @param pvz, the game.
&nbsp;     * @param gameTime, the gameTime of the game
&nbsp;     * @param hordesNumber, number of hordes.
&nbsp;     * @param hordesTime, hordes duration time.
&nbsp;     */
&nbsp;    private void startingGame( int gameTime) {
&nbsp;
<b class="fc">&nbsp;    }</b>
&nbsp;
&nbsp;    //Getters
&nbsp;    public List&lt;Element&gt;[][] getBoard(){
<b class="fc">&nbsp;        return board;</b>
&nbsp;    }
&nbsp;    public String[] getZombiesInGame(){
<b class="fc">&nbsp;        return zombiesInGame;</b>
&nbsp;    }
&nbsp;    public String[] getPlantsInGame(){
<b class="fc">&nbsp;        return plantsInGame;</b>
&nbsp;    }
&nbsp;    public Plant[][] getPlantsBoard(){
<b class="fc">&nbsp;        return plantsBoard;</b>
&nbsp;    }
&nbsp;    public List&lt;Mover&gt; getMoves(){
<b class="nc">&nbsp;        return moves;</b>
&nbsp;    }
<b class="fc">&nbsp;    public int getSuns(){return suns;}</b>
<b class="fc">&nbsp;    public int getBrains(){return brains;}</b>
<b class="nc">&nbsp;    public List&lt;Element&gt; getElements(){return elements;}</b>
<b class="nc">&nbsp;    public int getZombiePoints(){return zombiePoints;}</b>
<b class="nc">&nbsp;    public int getPlantPoints(){return plantPoints;}</b>
<b class="nc">&nbsp;    public void setBrains(int brains){this.brains+= brains;}</b>
<b class="nc">&nbsp;    public void setSuns(int suns){this.suns += suns;}</b>
<b class="nc">&nbsp;    public String getGameMode() {return game;}</b>
&nbsp;
&nbsp;    /*
&nbsp;     * Initializes the zombie board, setting up empty lists for each cell.
&nbsp;     */
&nbsp;
&nbsp;    private void startingBoards(){
<b class="fc">&nbsp;        for (int i = 0; i &lt; rows; i++) {</b>
<b class="fc">&nbsp;            for (int j = 0; j &lt; columns; j++) {</b>
<b class="fc">&nbsp;                board[i][j] = new ArrayList&lt;&gt;();</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Delete zombie of the board.
&nbsp;     * @param row, row of the zombie.
&nbsp;     * @param col, column of the zombie.
&nbsp;     */
&nbsp;    public void deleteZombie(int row, int col) {
<b class="pc">&nbsp;        for(Element element : board[row][col]){</b>
<b class="fc">&nbsp;            if(element instanceof Zombie zombie){</b>
<b class="fc">&nbsp;                if(zombie.getLife() &lt;= 0) {</b>
<b class="fc">&nbsp;                    attackers.remove(zombie);</b>
<b class="fc">&nbsp;                    moves.remove(element);</b>
<b class="fc">&nbsp;                    board[row][col].remove(zombie);</b>
<b class="fc">&nbsp;                    elements.remove(element);</b>
<b class="fc">&nbsp;                    if (zombie instanceof Shooter) shooters.remove(zombie);</b>
<b class="fc">&nbsp;                    zombiePoints -= zombie.getValue();</b>
&nbsp;                }
&nbsp;                break;
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Add a zombie to the board at a specified row and the last column.
&nbsp;     *
&nbsp;     * @param row    The row index where the zombie will be added.
&nbsp;     * @param zombie The type of zombie to be added.
&nbsp;     * @throws PVZException if the zombie is null or doesn&#39;t exist.
&nbsp;     */
&nbsp;    public void addZombie(int row, String zombie) throws PVZException {
<b class="fc">&nbsp;        Zombie newZombie = searchZombie(zombie,row);</b>
<b class="fc">&nbsp;        valideZombieExist(newZombie);</b>
<b class="fc">&nbsp;        board[row][9].add(newZombie);</b>
<b class="fc">&nbsp;        moves.add(newZombie);</b>
<b class="fc">&nbsp;        attackers.add(newZombie);</b>
<b class="fc">&nbsp;        if(newZombie instanceof Shooter shooter) {</b>
<b class="fc">&nbsp;            shooters.add(shooter);</b>
&nbsp;        }
<b class="fc">&nbsp;        if(newZombie instanceof GenerateCoins generateCoin) {</b>
<b class="fc">&nbsp;            generateCoins.add(generateCoin);</b>
&nbsp;        }
<b class="fc">&nbsp;        elements.add(newZombie);</b>
<b class="fc">&nbsp;        zombiePoints += newZombie.getValue();</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Add a zombie to the board at a specified row and the last column, with value.
&nbsp;     * @param zombie The type of zombie to be added.
&nbsp;     * @param row    The row index where the zombie will be added.
&nbsp;     * @throws PVZException if the zombie is null or doesn&#39;t exist.
&nbsp;     */
&nbsp;    public void addZombie(String zombie, int row) throws PVZException {
<b class="fc">&nbsp;        Zombie newZombie = searchZombie(zombie,row);</b>
<b class="fc">&nbsp;        valideZombieExist(newZombie);</b>
<b class="pc">&nbsp;        if(newZombie.getValue() &lt;= brains) {</b>
<b class="fc">&nbsp;            board[row][9].add(newZombie);</b>
<b class="fc">&nbsp;            moves.add(newZombie);</b>
<b class="fc">&nbsp;            attackers.add(newZombie);</b>
<b class="fc">&nbsp;            if(newZombie instanceof Shooter shooter) {</b>
<b class="fc">&nbsp;                shooters.add(shooter);</b>
&nbsp;            }
<b class="fc">&nbsp;            if(newZombie instanceof GenerateCoins generateCoin) {</b>
<b class="fc">&nbsp;                generateCoins.add(generateCoin);</b>
&nbsp;            }
<b class="fc">&nbsp;            elements.add(newZombie);</b>
<b class="fc">&nbsp;            zombiePoints += newZombie.getValue();</b>
<b class="fc">&nbsp;            brains -= newZombie.getValue();</b>
&nbsp;        }else{
<b class="nc">&nbsp;            throw new PVZException(PVZException.ERROR_NOT_ENOUGH_BRAINS);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Search zombie that want to add.
&nbsp;     * @param zombie, the string of the zombie.
&nbsp;     * @return Zombie, the Zombie.
&nbsp;     * @throws PVZException if the string is null;
&nbsp;     */
&nbsp;    private Zombie searchZombie(String zombie, int row) throws PVZException {
<b class="fc">&nbsp;        valideZombieNotNull(zombie);</b>
<b class="fc">&nbsp;        return switch (zombie) {</b>
<b class="fc">&nbsp;            case &quot;zombie&quot; -&gt; new BasicZombie(row);</b>
&nbsp;            case &quot;zombieCono&quot; -&gt; {
<b class="fc">&nbsp;                Shield cone = new Cone();</b>
<b class="fc">&nbsp;                yield new ZombieWithShield(row, cone);</b>
&nbsp;            }
&nbsp;            case &quot;zombieBalde&quot; -&gt; {
<b class="fc">&nbsp;                Shield bucket = new Bucket();</b>
<b class="fc">&nbsp;                yield new ZombieWithShield(row, bucket);</b>
&nbsp;            }
<b class="fc">&nbsp;            case &quot;brainstein&quot; -&gt; new Brainstein(row);</b>
<b class="fc">&nbsp;            case &quot;eciZombie&quot; -&gt; new ECIZombie(row);</b>
<b class="fc">&nbsp;            default -&gt; null;</b>
&nbsp;        };
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Validate that the string of the zombie isn&#39;t null.
&nbsp;     * @param zombie, string to validate.
&nbsp;     * @throws PVZException if the string is null.
&nbsp;     */
&nbsp;    private void valideZombieNotNull(String zombie) throws PVZException {
<b class="fc">&nbsp;        if (zombie == null) throw new PVZException(PVZException.ERROR_ZOMBIE_NOT_SELECTED);</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Validate that the Zombie exist.
&nbsp;     * @param zombie, the zombie to validate.
&nbsp;     * @throws PVZException if the Zombie is null.
&nbsp;     */
&nbsp;    private void valideZombieExist(Zombie zombie) throws PVZException {
<b class="fc">&nbsp;        if (zombie == null) throw new PVZException(PVZException.ERROR_ZOMBIE_NOT_EXIST);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Delete plant of the board.
&nbsp;     * @param row, row of the plant.
&nbsp;     * @param col, col of the board.
&nbsp;     * @throws PVZException, if there isn´t a plant to delete.
&nbsp;     */
&nbsp;    public void deletePlant(int row, int col) throws PVZException {
<b class="fc">&nbsp;        validePlantExistToDelete(row,col);</b>
<b class="fc">&nbsp;        Plant plant = plantsBoard[row][col];</b>
<b class="fc">&nbsp;        board[row][col].remove(plant);</b>
<b class="fc">&nbsp;        plantsBoard[row][col] = null;</b>
<b class="fc">&nbsp;        if(plant instanceof Attacker) attackers.remove(plant);</b>
<b class="fc">&nbsp;        if(plant instanceof Shooter)shooters.remove(plant);</b>
<b class="fc">&nbsp;        if(plant instanceof GenerateCoins) generateCoins.remove(plant);</b>
<b class="fc">&nbsp;        elements.remove(plant);</b>
<b class="fc">&nbsp;        plantPoints -= plant.getValue();</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Validate if exist plant to delete.
&nbsp;     * @param row of the plant to delete.
&nbsp;     * @param col of the plant to delete
&nbsp;     * @throws PVZException if there isn´t a plant in this position;
&nbsp;     */
&nbsp;    private void validePlantExistToDelete(int row, int col) throws PVZException {
<b class="fc">&nbsp;        if(plantsBoard[row][col] == null) throw new PVZException(PVZException.NOT_PLANT_TO_DELETE);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /**
&nbsp;     * Add a plant to the board at a specified position.
&nbsp;     *
&nbsp;     * @param row    The row index for the plant.
&nbsp;     * @param col    The column index for the plant.
&nbsp;     * @param plant The type of plant to be added.
&nbsp;     * @throws PVZException if planting is not allowed or the cell is not empty.
&nbsp;     */
&nbsp;    public  void addPlant(int row, int col, String plant)  throws PVZException{
<b class="fc">&nbsp;        valideCanPlant(row,col);</b>
<b class="fc">&nbsp;        valideEmptyCell(row,col);</b>
<b class="fc">&nbsp;        Plant newPlant = searchPlant(plant,row,col);</b>
<b class="fc">&nbsp;        validePlantExist(newPlant);</b>
<b class="pc">&nbsp;        if(newPlant.getValue()&lt;= suns) {</b>
<b class="fc">&nbsp;            elements.add(newPlant);</b>
<b class="fc">&nbsp;            plantsBoard[row][col] = newPlant;</b>
<b class="fc">&nbsp;            board[row][col].add(newPlant);</b>
<b class="fc">&nbsp;            suns -= newPlant.getValue();</b>
<b class="fc">&nbsp;            if(newPlant instanceof Attacker attacker) attackers.add(attacker);</b>
<b class="fc">&nbsp;            if(newPlant instanceof Shooter shooter ) shooters.add(shooter);</b>
<b class="fc">&nbsp;            if (newPlant instanceof GenerateCoins generateCoin ) generateCoins.add(generateCoin);</b>
<b class="fc">&nbsp;            plantPoints += (newPlant.getValue()*1.5);</b>
&nbsp;        }else{
<b class="nc">&nbsp;            throw new PVZException(PVZException.ERROR_NOT_ENOUGH_SUNS);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;
&nbsp;    /*
&nbsp;     * Search the Plant that is shown with the string.
&nbsp;     * @param plant, the string of the plant.
&nbsp;     * @param row, the row of the plant.
&nbsp;     * @param col, the col of the plant.
&nbsp;     * @return Plant, the Plant of the string.
&nbsp;     * @throws PVZException if the plant is null.
&nbsp;     */
&nbsp;    private Plant searchPlant(String plant,int row,int col) throws PVZException{
<b class="fc">&nbsp;        validePlantNotNull(plant);</b>
<b class="fc">&nbsp;        return switch (plant) {</b>
<b class="fc">&nbsp;            case &quot;peashooter&quot; -&gt; new Peashooter(row, col);</b>
<b class="fc">&nbsp;            case &quot;sunflower&quot; -&gt; new Sunflower(row, col);</b>
<b class="fc">&nbsp;            case &quot;wallnut&quot; -&gt; new Wallnut(row, col);</b>
<b class="fc">&nbsp;            case &quot;potatoMine&quot; -&gt; new PotatoMine(row, col);</b>
<b class="fc">&nbsp;            case &quot;eciPlant&quot; -&gt; new ECIPlant(row, col);</b>
<b class="fc">&nbsp;            default -&gt; null;</b>
&nbsp;        };
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /*
&nbsp;     * Validates whether a plant can be placed in the specified cell.
&nbsp;     *
&nbsp;     * @param row The row index of the cell.
&nbsp;     * @param col The column index of the cell.
&nbsp;     * @throws PVZException if planting is not allowed in the specified cell.
&nbsp;     */
&nbsp;    private void valideCanPlant(int row, int col) throws PVZException{
<b class="pc">&nbsp;        if(col == 0 || col == columns-1 ) throw new PVZException(PVZException.ERROR_CANT_PLANT);</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Validates whether a cell is empty before planting.
&nbsp;     *
&nbsp;     * @param row The row index of the cell.
&nbsp;     * @param col The column index of the cell.
&nbsp;     * @throws PVZException if the cell is not empty.
&nbsp;     */
&nbsp;    private void valideEmptyCell(int row, int col) throws PVZException{
<b class="pc">&nbsp;        if(plantsBoard[row][col] != null) throw new PVZException(PVZException.ERROR_CELDA_NOT_EMPTY);</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Validates plant exist.
&nbsp;     * @param plant, the plant.
&nbsp;     * @throws PVZException if the plant is null.
&nbsp;     *
&nbsp;     */
&nbsp;
&nbsp;    private void validePlantExist(Plant plant) throws PVZException{
<b class="fc">&nbsp;        if (plant == null) throw new PVZException(PVZException.ERROR_PLANT_NOT_EXIST);</b>
&nbsp;    }
&nbsp;    /*
&nbsp;     * Validates that a plant was selected.
&nbsp;     * @param plant, String of the plant.
&nbsp;     * @throws PVZException if the string is null.
&nbsp;     */
&nbsp;    private void validePlantNotNull(String plant) throws PVZException{
<b class="fc">&nbsp;        if (plant == null) throw new PVZException(PVZException.ERROR_PLANT_NOT_SELECTED);</b>
&nbsp;    }
&nbsp;    /**
&nbsp;     * Add a coin to the board in a specific
&nbsp;     *
&nbsp;     */
&nbsp;    public void addCoin(int row, int col,int finishRow, String coin) throws PVZException{
<b class="fc">&nbsp;        valideCoinNotNull(coin);</b>
<b class="fc">&nbsp;        Coin newCoin = searchCoin(coin,row,col,finishRow);</b>
<b class="fc">&nbsp;        valideCoinExist(newCoin);</b>
<b class="fc">&nbsp;        board[row][col].add(newCoin);</b>
<b class="fc">&nbsp;        moves.add(newCoin);</b>
<b class="fc">&nbsp;        elements.add(newCoin);</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Search a coin with the String.
&nbsp;     * @param String, string of the coin.
&nbsp;     * @return Coin, the coin of the string.
&nbsp;     */
&nbsp;    private Coin searchCoin(String coin, int row, int col,int finishRow) throws PVZException{
&nbsp;
<b class="fc">&nbsp;        return switch (coin) {</b>
<b class="fc">&nbsp;            case &quot;sun&quot; -&gt; new Sun(row, col, finishRow);</b>
<b class="fc">&nbsp;            case &quot;brain&quot; -&gt; new Brain(row, col, finishRow);</b>
<b class="fc">&nbsp;            case &quot;eciSun&quot; -&gt; new ECISun(row, col, finishRow);</b>
<b class="fc">&nbsp;            default -&gt; null;</b>
&nbsp;        };
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Validate coin is not null.
&nbsp;     * @param coin, String of the coin.
&nbsp;     * @throws PVZException if String is null
&nbsp;     *
&nbsp;     */
&nbsp;    private void valideCoinNotNull(String coin) throws PVZException{
<b class="fc">&nbsp;        if (coin == null) throw new PVZException(PVZException.ERROR_COIN_NULL);</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Validate coin exist.
&nbsp;     * @param coin, the Coin.
&nbsp;     * @throws PVZException if Coin doesn&#39;t exist.
&nbsp;     */
&nbsp;    private void valideCoinExist(Coin coin) throws PVZException{
<b class="fc">&nbsp;        if (coin == null) throw new PVZException(PVZException.ERROR_COIN_EXIST);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * move the elements that can be moved in the board.
&nbsp;     */
&nbsp;    public void moveBoard(){
<b class="fc">&nbsp;        for(Mover move : moves){</b>
<b class="fc">&nbsp;            Element moveElement = (Element) move;</b>
<b class="fc">&nbsp;            board[move.getRow()][move.getCol()].remove(moveElement);</b>
<b class="fc">&nbsp;            move.move();</b>
<b class="fc">&nbsp;            board[move.getRow()][move.getCol()].add(moveElement);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Take a coin of the board.
&nbsp;     * @param row, row of the coin.
&nbsp;     * @param col, col of the row.
&nbsp;     * @throws PVZException if not exist a coin in this cell.
&nbsp;     */
&nbsp;    public void takeCoin(int row, int col) throws PVZException{
<b class="fc">&nbsp;        Coin coin = coinInCell(row,col);</b>
<b class="pc">&nbsp;        if(coin != null) {</b>
<b class="fc">&nbsp;            if (coin instanceof Brain) {</b>
<b class="fc">&nbsp;                brains += coin.getValue();</b>
&nbsp;            } else {
<b class="fc">&nbsp;                suns += coin.getValue();</b>
&nbsp;            }
<b class="fc">&nbsp;            board[row][col].remove(coin);</b>
<b class="fc">&nbsp;            moves.remove(coin);</b>
<b class="fc">&nbsp;            elements.remove(coin);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Look if a position don&#39;t have a coin.
&nbsp;     * @param row of the coin.
&nbsp;     * @param col of the coin.
&nbsp;     * @return if exist a coin false, if not true.
&nbsp;     */
&nbsp;    public boolean isEmptyOfCoins(int row, int col){
<b class="pc">&nbsp;        for(Element element : board[row][col]) if (element instanceof Coin ) return false;</b>
<b class="fc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Take the coin of the cell.
&nbsp;     * @param row, row of the coin.
&nbsp;     * @param col, col of the coin.
&nbsp;     */
&nbsp;    private Coin coinInCell(int row, int col){
<b class="pc">&nbsp;        for(Element element : board[row][col]){</b>
<b class="pc">&nbsp;            if (element instanceof Coin coin){</b>
<b class="fc">&nbsp;                return coin;</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Adds a missile to the specified cell on the board and updates relevant collections.
&nbsp;     * @param row the row of the cell
&nbsp;     * @param col the column of the cell
&nbsp;     * @param missile the missile to be added
&nbsp;     */
&nbsp;    private void addMissile(int row, int col, Missile missile) {
<b class="fc">&nbsp;        if (missile == null) return;</b>
<b class="fc">&nbsp;        board[row][col].add(missile);</b>
<b class="fc">&nbsp;        moves.add(missile);</b>
<b class="fc">&nbsp;        attackers.add(missile);</b>
<b class="fc">&nbsp;        elements.add(missile);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Removes a missile from the specified cell on the board and updates relevant collections.
&nbsp;     * @param row the row of the cell
&nbsp;     * @param col the column of the cell
&nbsp;     * @param missile the missile to be removed
&nbsp;     */
&nbsp;    private void deleteMissile(int row, int col, Missile missile) {
<b class="fc">&nbsp;        board[row][col].remove(missile);</b>
<b class="fc">&nbsp;        moves.remove(missile);</b>
<b class="fc">&nbsp;        attackers.remove(missile);</b>
<b class="fc">&nbsp;        elements.remove(missile);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Processes the damage logic for all attackers in the game.
&nbsp;     */
&nbsp;    public void makeDamage() {
<b class="fc">&nbsp;        for (int i = 0; i &lt; attackers.size(); i++) {</b>
<b class="fc">&nbsp;            Attacker attacker = attackers.get(i);</b>
<b class="pc">&nbsp;            if (i &lt; attackers.size()) {</b>
<b class="fc">&nbsp;                Zombie zombie = zombieInCell(attacker.getRow(), attacker.getCol());</b>
<b class="fc">&nbsp;                Plant plant = plantInCell(attacker.getRow(), attacker.getCol());</b>
&nbsp;
<b class="pc">&nbsp;                switch (attacker) {</b>
<b class="fc">&nbsp;                    case Pea p -&gt; {</b>
<b class="fc">&nbsp;                        if (zombie != null) {</b>
<b class="fc">&nbsp;                            p.makeDamage(zombie);</b>
<b class="fc">&nbsp;                            deleteMissile(p.getRow(), p.getCol(), p);</b>
&nbsp;                        }
&nbsp;                    }
<b class="fc">&nbsp;                    case POOmBa p -&gt; {</b>
<b class="fc">&nbsp;                        if (plant != null) {</b>
<b class="fc">&nbsp;                            p.makeDamage(plant);</b>
<b class="fc">&nbsp;                            deleteMissile(p.getRow(), p.getCol(), p);</b>
&nbsp;                        }
&nbsp;                    }
<b class="fc">&nbsp;                    case Zombie z -&gt; {</b>
<b class="fc">&nbsp;                        if (plant != null) {</b>
<b class="fc">&nbsp;                            z.makeDamage(plant);</b>
<b class="fc">&nbsp;                            z.makeAttack();</b>
&nbsp;                        }
&nbsp;                    }
<b class="fc">&nbsp;                    case PotatoMine potatoMine -&gt; {</b>
<b class="fc">&nbsp;                        potatoMine.makeDamage(zombie);</b>
&nbsp;                    }
<b class="fc">&nbsp;                    case LawnMower lawnMower -&gt; {</b>
<b class="fc">&nbsp;                        List&lt;Zombie&gt; zombieList = allTheZombieInCell(attacker.getRow(), attacker.getCol());</b>
<b class="fc">&nbsp;                        for (Zombie z : zombieList) {</b>
<b class="fc">&nbsp;                            lawnMower.makeDamage(z);</b>
&nbsp;                        }
&nbsp;                    }
&nbsp;                    default -&gt; {}
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Retrieves the plant in the specified cell.
&nbsp;     * @param row the row of the cell
&nbsp;     * @param col the column of the cell
&nbsp;     * @return the plant in the cell or null if none exists
&nbsp;     */
&nbsp;    private Plant plantInCell(int row, int col) {
<b class="fc">&nbsp;        return plantsBoard[row][col] != null ? plantsBoard[row][col] : null;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Retrieves the zombie in the specified cell.
&nbsp;     * @param row the row of the cell
&nbsp;     * @param col the column of the cell
&nbsp;     * @return the zombie in the cell or null if none exists
&nbsp;     */
&nbsp;    private Zombie zombieInCell(int row, int col) {
<b class="fc">&nbsp;        for (Element element : board[row][col]) {</b>
<b class="fc">&nbsp;            if (element instanceof Zombie zombie) {</b>
<b class="fc">&nbsp;                return zombie;</b>
&nbsp;            }
&nbsp;        }
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Removes elements with zero or negative life from the game.
&nbsp;     */
&nbsp;    public void garbageColector() {
<b class="fc">&nbsp;        int len = elements.size();</b>
<b class="fc">&nbsp;        for (int i = 0; i &lt; len; i++) {</b>
<b class="fc">&nbsp;            if (i &lt; elements.size()) {</b>
<b class="fc">&nbsp;                Element element = elements.get(i);</b>
<b class="fc">&nbsp;                if (element.getLife() &lt;= 0) {</b>
<b class="fc">&nbsp;                    deleteElement(element, element.getRow(), element.getCol());</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Deletes an element from the game.
&nbsp;     * @param element the element to delete
&nbsp;     * @param row the row of the element
&nbsp;     * @param col the column of the element
&nbsp;     */
&nbsp;    private void deleteElement(Element element, int row, int col) {
&nbsp;        try {
<b class="pc">&nbsp;            switch (element) {</b>
<b class="fc">&nbsp;                case Plant p -&gt; deletePlant(row, col);</b>
<b class="fc">&nbsp;                case Zombie z -&gt; deleteZombie(row, col);</b>
<b class="nc">&nbsp;                case Pea pe -&gt; deleteMissile(row, col, pe);</b>
<b class="fc">&nbsp;                case LawnMower lm -&gt; deleteLawnMower(row, col, lm);</b>
&nbsp;                default -&gt; {}
&nbsp;            }
&nbsp;        } catch (PVZException e) {
<b class="nc">&nbsp;            System.out.println(e.getMessage());</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Checks if there is a zombie in the specified row.
&nbsp;     * @param row the row to check
&nbsp;     * @return true if there is a zombie, false otherwise
&nbsp;     */
&nbsp;    private boolean zombieInRow(int row) {
<b class="pc">&nbsp;        for (List&lt;Element&gt; elements : board[row]) {</b>
<b class="fc">&nbsp;            for (Element element : elements) {</b>
<b class="fc">&nbsp;                if (element instanceof Zombie) {</b>
<b class="fc">&nbsp;                    return true;</b>
&nbsp;                }
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Checks if there is a plant in the specified row.
&nbsp;     * @param row the row to check
&nbsp;     * @return true if there is a plant, false otherwise
&nbsp;     */
&nbsp;    private boolean plantInRow(int row) {
<b class="fc">&nbsp;        for (Plant p : plantsBoard[row]) {</b>
<b class="fc">&nbsp;            if (p != null) {</b>
<b class="fc">&nbsp;                return true;</b>
&nbsp;            }
&nbsp;        }
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Triggers the shooting logic for all shooters in the game.
&nbsp;     */
&nbsp;    public void makeShoot() {
<b class="fc">&nbsp;        for (Shooter shooter : shooters) {</b>
<b class="fc">&nbsp;            boolean peashooterShoot = zombieInRow(shooter.getRow());</b>
<b class="fc">&nbsp;            boolean eciZombieShoot = plantInRow(shooter.getRow());</b>
&nbsp;            Missile missile;
<b class="fc">&nbsp;            if (shooter instanceof Plant) missile = shooter.shoot(peashooterShoot);</b>
<b class="fc">&nbsp;            else missile = shooter.shoot(eciZombieShoot);</b>
<b class="fc">&nbsp;            addMissile(shooter.getRow(), shooter.getCol(), missile);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Generates coins for all coin generators in the game.
&nbsp;     * @throws PVZException if an error occurs during coin generation
&nbsp;     */
&nbsp;    public void generateSun() throws PVZException {
<b class="nc">&nbsp;        for (GenerateCoins generateCoins : generateCoins) {</b>
<b class="nc">&nbsp;            generateCoins.makeCoins(this);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Adds a lawn mower to the specified row.
&nbsp;     * @param row the row to add the lawn mower
&nbsp;     */
&nbsp;    private void addLawnMower(int row) {
<b class="fc">&nbsp;        LawnMower lawnMower = new LawnMower(row, 0);</b>
<b class="fc">&nbsp;        elements.add(lawnMower);</b>
<b class="fc">&nbsp;        board[row][0].add(lawnMower);</b>
<b class="fc">&nbsp;        attackers.add(lawnMower);</b>
<b class="fc">&nbsp;        moves.add(lawnMower);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Removes a lawn mower from the specified cell.
&nbsp;     * @param row the row of the cell
&nbsp;     * @param col the column of the cell
&nbsp;     * @param lawnMower the lawn mower to remove
&nbsp;     */
&nbsp;    private void deleteLawnMower(int row, int col, LawnMower lawnMower) {
<b class="fc">&nbsp;        elements.remove(lawnMower);</b>
<b class="fc">&nbsp;        board[row][col].remove(lawnMower);</b>
<b class="fc">&nbsp;        attackers.remove(lawnMower);</b>
<b class="fc">&nbsp;        moves.remove(lawnMower);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Generates lawn mowers for all rows in the game.
&nbsp;     */
&nbsp;    private void generateLawnMower() {
<b class="fc">&nbsp;        for (int row = 0; row &lt; rows; row++) {</b>
<b class="fc">&nbsp;            addLawnMower(row);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Retrieves all zombies in the specified cell.
&nbsp;     * @param row the row of the cell
&nbsp;     * @param col the column of the cell
&nbsp;     * @return a list of zombies in the cell
&nbsp;     */
&nbsp;    private List&lt;Zombie&gt; allTheZombieInCell(int row, int col) {
<b class="fc">&nbsp;        List&lt;Zombie&gt; zombieList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        for (Element element : board[row][col]) {</b>
<b class="fc">&nbsp;            if (element instanceof Zombie zombie) {</b>
<b class="fc">&nbsp;                zombieList.add(zombie);</b>
&nbsp;            }
&nbsp;        }
<b class="fc">&nbsp;        return zombieList;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Ends the game, stopping timers and updating game states.
&nbsp;     */
&nbsp;    public void endGame() {
<b class="nc">&nbsp;        gameTimer.stop();</b>
<b class="nc">&nbsp;        gameMode.finishGame();</b>
<b class="nc">&nbsp;        zombieMachine.finishGame();</b>
<b class="nc">&nbsp;        gameFinished = true;</b>
<b class="nc">&nbsp;        zombiePoints += brains;</b>
<b class="nc">&nbsp;        plantPoints += suns;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Ends the game with specific logic for a second mode.
&nbsp;     */
&nbsp;    public void endGameTwo() {
<b class="nc">&nbsp;        plantMachine.finishGame();</b>
<b class="nc">&nbsp;        endGame();</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Checks if the game has finished.
&nbsp;     * @return true if the game is finished, false otherwise
&nbsp;     */
&nbsp;    public boolean gameIsFinished() {
<b class="fc">&nbsp;        return gameFinished;</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Checks if a zombie has reached the last cell, and updates game state if so.
&nbsp;     */
&nbsp;    public void zombieInLastCell() {
<b class="fc">&nbsp;        boolean flag = false;</b>
<b class="fc">&nbsp;        for (int row = 0; row &lt; rows; row++) {</b>
<b class="fc">&nbsp;            int len = board[row][0].size();</b>
<b class="fc">&nbsp;            for (int j = 0; j &lt; len; j++) {</b>
<b class="pc">&nbsp;                if (j &lt; board[row][0].size()) {</b>
<b class="fc">&nbsp;                    Element element = board[row][0].get(j);</b>
<b class="fc">&nbsp;                    if (element instanceof LawnMower lm) {</b>
<b class="fc">&nbsp;                        flag = true;</b>
&nbsp;                    }
<b class="pc">&nbsp;                    if (element instanceof Zombie zombie &amp;&amp; !flag) {</b>
<b class="fc">&nbsp;                        gameFinished = true;</b>
<b class="fc">&nbsp;                        zombiePoints = 1000000000;</b>
<b class="fc">&nbsp;                        plantPoints = 0;</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            }
<b class="fc">&nbsp;            flag = false;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;}
&nbsp;
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-12-16 16:10</div>
</div>
</body>
</html>
