


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > PVZInGame</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">&lt;empty package name&gt;</a>
</div>

<h1>Coverage Summary for Class: PVZInGame (&lt;empty package name&gt;)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">PVZInGame</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/22)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/54)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/212)
  </span>
</td>
</tr>
  <tr>
    <td class="name">PVZInGame$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/8)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/53)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">PVZInGame$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/2)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/26)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/62)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/267)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;
&nbsp;import java.io.*;
&nbsp;import java.util.*;
&nbsp;import javax.swing.*;
&nbsp;import javax.swing.Timer;
&nbsp;import java.awt.*;
&nbsp;import java.awt.event.WindowAdapter;
&nbsp;import java.awt.event.WindowEvent;
&nbsp;
&nbsp;/**
&nbsp; * This is the window of the gameBoard.
&nbsp; *
&nbsp; * @author Miguel Angel Vanegas y Julian Castiblanco.
&nbsp; * @version 1.0
&nbsp; */
&nbsp;public class PVZInGame extends JFrame implements GeneralInterface, Serializable {
&nbsp;    private JPanel gamePanel;
&nbsp;    private JMenuItem open, save, newItem, exit;
&nbsp;    private String gameMode, selectedPlant, plantPlayer,zombiePlayer,plantsType,zombieType;
&nbsp;    private String[] plantsToPlay;
&nbsp;    private String[] zombiesToPlay;
&nbsp;    private JButton[] plantsButtons;
&nbsp;    private JButton[] zombiesButtons;
<b class="nc">&nbsp;    private JButton[][] cells = new JButton[5][10];</b>
&nbsp;    private PVZ pvz;
&nbsp;    private Timer timer;
&nbsp;    private JLabel sunsLabel,brainsLabel,zombiePoints, plantPoints;
<b class="nc">&nbsp;    private boolean shovelBoolean = false;</b>
&nbsp;    private JButton shovelButton;
&nbsp;
&nbsp;    /**
&nbsp;     * Constructor for PVZInGame PvsM.
&nbsp;     *
&nbsp;     * @param gameMode       The game mode (&quot;PvsP&quot;, &quot;PvsM&quot;, or &quot;MvsM&quot;).
&nbsp;     * @param plantasToPlay  The set of plants available to play.
&nbsp;     * @param zombiesToPlay  The set of zombies available to play.
&nbsp;     * @param plantPlayer    The plant player name.
&nbsp;     * @param zombieType     The zombie type.
&nbsp;     * @param startingSuns   The start number of suns.
&nbsp;     * @param gameTime       The time in game.
&nbsp;     * @param hordesTime     The hordes duration time.
&nbsp;     * @param hordesNumber   The number of hordes for game.
&nbsp;     *
&nbsp;     */
<b class="nc">&nbsp;    public PVZInGame(String gameMode, HashSet&lt;String&gt; plantasToPlay,HashSet&lt;String&gt; zombiesToPlay,String plantPlayer,String zombieType,int startingBrains, int startingSuns, int gameTime, int hordesTime,int hordesNumber) {</b>
<b class="nc">&nbsp;        this.gameMode = gameMode;</b>
<b class="nc">&nbsp;        this.plantsToPlay = plantasToPlay.toArray(new String[0]);</b>
<b class="nc">&nbsp;        plantsButtons = new JButton[this.plantsToPlay.length];</b>
<b class="nc">&nbsp;        this.zombiesToPlay = zombiesToPlay.toArray(new String[0]);</b>
<b class="nc">&nbsp;        boolean booleanZombieType = (zombieType.equals(&quot;ZombiesOriginal&quot;));</b>
<b class="nc">&nbsp;        pvz = new PVZ(this.plantsToPlay,this.zombiesToPlay, booleanZombieType,startingSuns,startingBrains,gameTime,hordesNumber,hordesTime);</b>
<b class="nc">&nbsp;        this.plantPlayer = plantPlayer;</b>
<b class="nc">&nbsp;        this.zombieType = zombieType;</b>
<b class="nc">&nbsp;        prepareElements();</b>
<b class="nc">&nbsp;        prepareActions();</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Constructor for PVZInGame PvsP.
&nbsp;     * @param plantasToPlay  The set of plants available to play.
&nbsp;     * @param zombiesToPlay  The set of zombies available to play.
&nbsp;     * @param plantPlayer    The plant player name.
&nbsp;     * @param zombiePlayer   The zombie player name.
&nbsp;     * @param gameMode       The game mode (&quot;PvsP&quot;, &quot;PvsM&quot;, or &quot;MvsM&quot;).
&nbsp;     * @param startingBrains The start number of brains.
&nbsp;     * @param startingSuns   The start number of suns.
&nbsp;     */
<b class="nc">&nbsp;    public PVZInGame( HashSet&lt;String&gt; plantasToPlay,HashSet&lt;String&gt; zombiesToPlay,String plantPlayer,String zombiePlayer,String gameMode,int startingBrains, int startingSuns, int gameTime) {</b>
<b class="nc">&nbsp;        this.gameMode = gameMode;</b>
<b class="nc">&nbsp;        this.plantsToPlay = plantasToPlay.toArray(new String[0]);</b>
<b class="nc">&nbsp;        plantsButtons = new JButton[this.plantsToPlay.length];</b>
<b class="nc">&nbsp;        this.zombiesToPlay = zombiesToPlay.toArray(new String[0]);</b>
<b class="nc">&nbsp;        pvz = new PVZ(this.plantsToPlay,this.zombiesToPlay,startingSuns,startingBrains,gameTime);</b>
<b class="nc">&nbsp;        this.plantPlayer = plantPlayer;</b>
<b class="nc">&nbsp;        this.zombiePlayer = zombiePlayer;</b>
<b class="nc">&nbsp;        prepareElements();</b>
<b class="nc">&nbsp;        prepareActions();</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Constructor for PVZInGame MvsM.
&nbsp;     * @param gameMode       The game mode (&quot;PvsP&quot;, &quot;PvsM&quot;, or &quot;MvsM&quot;).
&nbsp;     * @param zombieType     The zombie type.
&nbsp;     * @param plantType      The plant type.
&nbsp;     * @param plantasToPlay  The set of plants available to play.
&nbsp;     * @param zombiesToPlay  The set of zombies available to play.
&nbsp;     * @param gameTime       The time in game.
&nbsp;     * @param hordesTime     The hordes duration time.
&nbsp;     * @param hordesNumber   The number of hordes for game.
&nbsp;     */
<b class="nc">&nbsp;    public PVZInGame(String plantType,String zombieType,String gameMode,HashSet&lt;String&gt; plantasToPlay,HashSet&lt;String&gt; zombiesToPlay, int startingBrains, int startingSuns, int gameTime, int hordesTime,int hordesNumber) {</b>
<b class="nc">&nbsp;        this.gameMode = gameMode;</b>
<b class="nc">&nbsp;        this.plantsToPlay = plantasToPlay.toArray(new String[0]);</b>
<b class="nc">&nbsp;        plantsButtons = new JButton[this.plantsToPlay.length];</b>
<b class="nc">&nbsp;        this.zombiesToPlay = zombiesToPlay.toArray(new String[0]);</b>
<b class="nc">&nbsp;        boolean booleanZombieType = (zombieType.equals(&quot;ZombiesOriginal&quot;));</b>
<b class="nc">&nbsp;        boolean booleanPlantType = (plantType.equals(&quot;PlantsIntelligent&quot;));</b>
<b class="nc">&nbsp;        pvz = new PVZ(this.plantsToPlay,this.zombiesToPlay, booleanZombieType,booleanPlantType,startingSuns,startingBrains,gameTime,hordesNumber,hordesTime);</b>
<b class="nc">&nbsp;        this.plantsType = plantType;</b>
<b class="nc">&nbsp;        this.zombieType = zombieType;</b>
<b class="nc">&nbsp;        prepareElements();</b>
<b class="nc">&nbsp;        prepareActions();</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;
&nbsp;    /*
&nbsp;     * Prepares all the graphical and logical components of the game.
&nbsp;     */
&nbsp;    private void prepareElements() {
&nbsp;
<b class="nc">&nbsp;        prepareElementsMenu();</b>
<b class="nc">&nbsp;        createPanel();</b>
<b class="nc">&nbsp;        if(gameMode.equals(&quot;PvsP&quot;)) {</b>
<b class="nc">&nbsp;            prepareButtonsZombies();</b>
<b class="nc">&nbsp;            prepareButtonsPlants();</b>
<b class="nc">&nbsp;            JLabel label = new JLabel(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+plantPlayer+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;            label.setBounds(20,0,plantPlayer.length()*20,50);</b>
<b class="nc">&nbsp;            gamePanel.add(label);</b>
<b class="nc">&nbsp;            JLabel label2 = new JLabel(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+zombiePlayer+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;            label2.setBounds(920,0,zombiePlayer.length()*20,50);</b>
<b class="nc">&nbsp;            gamePanel.add(label2);</b>
&nbsp;        }
<b class="nc">&nbsp;        if(gameMode.equals(&quot;PvsM&quot;)){</b>
<b class="nc">&nbsp;            prepareButtonsPlants();</b>
<b class="nc">&nbsp;            JLabel label = new JLabel(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+plantPlayer+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;            label.setBounds(20,0,plantPlayer.length()*20,50);</b>
<b class="nc">&nbsp;            gamePanel.add(label);</b>
<b class="nc">&nbsp;            JLabel label2 = new JLabel(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+zombieType+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;            label2.setBounds(920,0,zombieType.length()*20,50);</b>
<b class="nc">&nbsp;            gamePanel.add(label2);</b>
&nbsp;        }
<b class="nc">&nbsp;        if(gameMode.equals(&quot;MvsM&quot;)){</b>
<b class="nc">&nbsp;            JLabel label = new JLabel(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+plantsType+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;            label.setBounds(20,0,plantsType.length()*20,50);</b>
<b class="nc">&nbsp;            gamePanel.add(label);</b>
<b class="nc">&nbsp;            JLabel label2 = new JLabel(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+zombieType+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;            label2.setBounds(920,0,zombieType.length()*20,50);</b>
<b class="nc">&nbsp;            gamePanel.add(label2);</b>
&nbsp;        }
<b class="nc">&nbsp;        changeSizeToImage(&quot;fondoTablero.png&quot;);</b>
<b class="nc">&nbsp;        if(!gameMode.equals(&quot;MvsM&quot;))prepareButtonsTablero();</b>
<b class="nc">&nbsp;        timer = new Timer(100, e -&gt; refresh());</b>
<b class="nc">&nbsp;        timer.start();</b>
<b class="nc">&nbsp;        shovelButton = new BorderButton(&quot; &quot;);</b>
<b class="nc">&nbsp;        shovelButton.setBounds(540, 5, 40, 40);</b>
<b class="nc">&nbsp;        sunsLabel = new JLabel();</b>
<b class="nc">&nbsp;        brainsLabel = new JLabel();</b>
<b class="nc">&nbsp;        zombiePoints = new JLabel();</b>
<b class="nc">&nbsp;        plantPoints = new JLabel();</b>
<b class="nc">&nbsp;        gamePanel.add(plantPoints);</b>
<b class="nc">&nbsp;        gamePanel.add(zombiePoints);</b>
<b class="nc">&nbsp;        gamePanel.add(shovelButton);</b>
<b class="nc">&nbsp;        gamePanel.add(brainsLabel);</b>
<b class="nc">&nbsp;        gamePanel.add(sunsLabel);</b>
&nbsp;
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Creates and configures the game panel where the game board and elements are drawn.
&nbsp;     */
&nbsp;    private void createPanel(){
&nbsp;        // Crear panel con las plantas que se van a jugar
<b class="nc">&nbsp;        ImageIcon icon = getImageIcon(&quot;fondoTablero.png&quot;);</b>
<b class="nc">&nbsp;        Image originalImage = icon.getImage();</b>
&nbsp;
<b class="nc">&nbsp;        gamePanel = new JPanel() {</b>
&nbsp;            @Override
&nbsp;            protected void paintComponent(Graphics g) {
&nbsp;
<b class="nc">&nbsp;                super.paintComponent(g);</b>
&nbsp;                //zone of plants anzombies select.
<b class="nc">&nbsp;                g.drawImage(originalImage, 0, 0, getWidth(), getHeight(), null);</b>
<b class="nc">&nbsp;                ImageIcon icon = getImageIcon(&quot;pala.png&quot;);</b>
<b class="nc">&nbsp;                Image originalImage = icon.getImage();</b>
<b class="nc">&nbsp;                g.drawImage(originalImage, 540, 5, 40, 40, null);</b>
<b class="nc">&nbsp;                int count = 50;</b>
<b class="nc">&nbsp;                for (String planta : plantsToPlay) {</b>
<b class="nc">&nbsp;                    ImageIcon iconPlant = getImageIcon(planta+&quot;.png&quot;);</b>
<b class="nc">&nbsp;                    Image originalImagePlant = iconPlant.getImage();</b>
<b class="nc">&nbsp;                    g.drawImage(originalImagePlant, 20, count, 40, 60, null);</b>
<b class="nc">&nbsp;                    count += 70;</b>
&nbsp;                }
<b class="nc">&nbsp;                count = 50;</b>
<b class="nc">&nbsp;                for (String zombie : zombiesToPlay) {</b>
<b class="nc">&nbsp;                    ImageIcon iconZombie = getImageIcon(zombie + &quot;.png&quot;);</b>
<b class="nc">&nbsp;                    Image originalImageZombie = iconZombie.getImage();</b>
<b class="nc">&nbsp;                    g.drawImage(originalImageZombie, 930, count, 60, 60, null);</b>
<b class="nc">&nbsp;                    count += 70;</b>
&nbsp;                }
<b class="nc">&nbsp;                for(Element element: pvz.getElements()) {</b>
<b class="nc">&nbsp;                    if (element instanceof ZombieWithShield) {</b>
<b class="nc">&nbsp;                        Shield shield = ((ZombieWithShield) element).getShield();</b>
<b class="nc">&nbsp;                        ImageIcon iconZombie = getImageIcon(element.getName() + shield.getName() + element.getExtension());</b>
<b class="nc">&nbsp;                        Image originalImageZombie = iconZombie.getImage();</b>
<b class="nc">&nbsp;                        g.drawImage(originalImageZombie, element.getXPosition(), element.getYPosition(), element.getWidth(), element.getHeight(), null);</b>
&nbsp;                    } else {
<b class="nc">&nbsp;                        ImageIcon iconZombie = getImageIcon(element.getName() + element.getExtension());</b>
<b class="nc">&nbsp;                        Image originalImageZombie = iconZombie.getImage();</b>
<b class="nc">&nbsp;                        g.drawImage(originalImageZombie, element.getXPosition(), element.getYPosition(), element.getWidth(), element.getHeight(), null);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;                //name or type zone
<b class="nc">&nbsp;                g.setColor(new Color(101, 67, 33));</b>
<b class="nc">&nbsp;                g.fillRect(10, 5,250, 40);</b>
<b class="nc">&nbsp;                g.setColor(new Color(100, 100, 100));</b>
<b class="nc">&nbsp;                g.fillRect(910, 5, 250, 40);</b>
&nbsp;                //sun counter
<b class="nc">&nbsp;                g.setColor(new Color(139, 69, 19));</b>
<b class="nc">&nbsp;                g.fillRect(280, 5, 120, 40);</b>
<b class="nc">&nbsp;                ImageIcon iconSun = getImageIcon( &quot;sun.png&quot;);</b>
<b class="nc">&nbsp;                Image originalImageSun = iconSun.getImage();</b>
<b class="nc">&nbsp;                g.drawImage(originalImageSun, 285, 10, 30, 30, null);</b>
<b class="nc">&nbsp;                sunsLabel.setText(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+pvz.getSuns()+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;                sunsLabel.setBounds(320,5,80,40);</b>
&nbsp;                //brain counter
<b class="nc">&nbsp;                g.setColor(new Color(150, 150, 150));</b>
<b class="nc">&nbsp;                g.fillRect(760, 5, 120, 40);</b>
<b class="nc">&nbsp;                ImageIcon iconBrain = getImageIcon( &quot;brain.png&quot;);</b>
<b class="nc">&nbsp;                Image originalImageBrain = iconBrain.getImage();</b>
<b class="nc">&nbsp;                g.drawImage(originalImageBrain, 765, 10, 30, 30, null);</b>
<b class="nc">&nbsp;                brainsLabel.setText(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+pvz.getBrains()+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;                brainsLabel.setBounds(800 ,5,80,40);</b>
&nbsp;                // zombiePoints
<b class="nc">&nbsp;                g.setColor(new Color(150, 150, 150));</b>
<b class="nc">&nbsp;                g.fillRect(630, 5, 120, 40);</b>
<b class="nc">&nbsp;                zombiePoints.setText(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+pvz.getZombiePoints()+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;                zombiePoints.setBounds(640 ,5,80,40);</b>
<b class="nc">&nbsp;                g.setColor(new Color(139, 69, 19));</b>
<b class="nc">&nbsp;                g.fillRect(410, 5, 120, 40);</b>
<b class="nc">&nbsp;                plantPoints.setText(&quot;&lt;html&gt;&lt;span style=&#39;font-size:20px; letter-spacing:5px;&#39;&gt;&quot;+pvz.getPlantPoints()+&quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;                plantPoints.setBounds(420,5,80,40);</b>
&nbsp;            }
&nbsp;        };
&nbsp;
<b class="nc">&nbsp;        gamePanel.setLayout(null); // Usar layout absoluto para colocar botones</b>
<b class="nc">&nbsp;        setContentPane(gamePanel);</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Adjusts the JFrame size to match the dimensions of an image.
&nbsp;     *
&nbsp;     * @param imageName The name of the image file.
&nbsp;     */
&nbsp;    private void changeSizeToImage(String imageName) {
<b class="nc">&nbsp;        ImageIcon icon = getImageIcon(imageName);</b>
&nbsp;
<b class="nc">&nbsp;        int imageWidth = icon.getIconWidth();</b>
<b class="nc">&nbsp;        int imageHeight = icon.getIconHeight();</b>
&nbsp;
<b class="nc">&nbsp;        setSize(imageWidth, imageHeight);</b>
&nbsp;
<b class="nc">&nbsp;        setLocationRelativeTo(null);</b>
<b class="nc">&nbsp;        setResizable(false);</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Prepares the menu bar for the game.
&nbsp;     */
&nbsp;    private void prepareElementsMenu(){
<b class="nc">&nbsp;        JMenuBar menuBar = new JMenuBar();</b>
<b class="nc">&nbsp;        JMenu menu = new JMenu(&quot;Menu&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        open = new JMenu(&quot;Open&quot;);</b>
<b class="nc">&nbsp;        save = new JMenuItem(&quot;Save&quot;);</b>
<b class="nc">&nbsp;        newItem = new JMenuItem(&quot;New&quot;);</b>
<b class="nc">&nbsp;        exit = new JMenuItem(&quot;Exit&quot;);</b>
&nbsp;
<b class="nc">&nbsp;        menu.add(open);</b>
<b class="nc">&nbsp;        menu.add(save);</b>
<b class="nc">&nbsp;        menu.add(newItem);</b>
<b class="nc">&nbsp;        menu.add(exit);</b>
&nbsp;
<b class="nc">&nbsp;        menuBar.add(menu);</b>
<b class="nc">&nbsp;        setJMenuBar(menuBar);</b>
&nbsp;
&nbsp;    }
&nbsp;    /*
&nbsp;     * Prepares the game board (grid of cells) for the game.
&nbsp;     * Each cell is represented by a transparent button.
&nbsp;     */
&nbsp;    private void prepareButtonsTablero() {
<b class="nc">&nbsp;        int startCol = 140;</b>
<b class="nc">&nbsp;        int startRow =55;</b>
<b class="nc">&nbsp;        for (int row = 0; row &lt; 5; row++) {</b>
<b class="nc">&nbsp;            for (int col = 0; col &lt; 10; col++) {</b>
<b class="nc">&nbsp;                cells[row][col] = new TransparentButton(&quot;&quot;);</b>
<b class="nc">&nbsp;                cells[row][col].setBounds(startCol,startRow,70,75);</b>
<b class="nc">&nbsp;                gamePanel.add(cells[row][col]);</b>
<b class="nc">&nbsp;                startCol +=70 ;</b>
&nbsp;            }
<b class="nc">&nbsp;            startCol = 140;</b>
<b class="nc">&nbsp;            startRow += 75 ;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Prepares the buttons representing plants available for the player.
&nbsp;     * Buttons are aligned vertically on the left side of the game panel.
&nbsp;     */
&nbsp;    private void prepareButtonsPlants() {
<b class="nc">&nbsp;        int row = 50;</b>
&nbsp;        int len;
<b class="nc">&nbsp;        len = plantsToPlay.length;</b>
<b class="nc">&nbsp;        plantsButtons = new JButton[len];</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; len; i++) {</b>
<b class="nc">&nbsp;            plantsButtons[i] = new BorderButton(&quot; &quot;);</b>
<b class="nc">&nbsp;            plantsButtons[i].setBounds(20,row,40,60);</b>
<b class="nc">&nbsp;            row += 70;</b>
<b class="nc">&nbsp;            gamePanel.add(plantsButtons[i]);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Prepares the buttons representing zombies available for the player.
&nbsp;     * Buttons are aligned vertically on the left side of the game panel.
&nbsp;     */
&nbsp;    private void prepareButtonsZombies() {
<b class="nc">&nbsp;        int row = 50;</b>
&nbsp;        int len;
<b class="nc">&nbsp;        len = zombiesToPlay.length;</b>
<b class="nc">&nbsp;        zombiesButtons = new JButton[len];</b>
<b class="nc">&nbsp;        for (int i = 0; i &lt; len; i++) {</b>
<b class="nc">&nbsp;            zombiesButtons[i] = new BorderButton(&quot; &quot;);</b>
<b class="nc">&nbsp;            zombiesButtons[i].setBounds(930,row,60,60);</b>
<b class="nc">&nbsp;            row += 70;</b>
<b class="nc">&nbsp;            gamePanel.add(zombiesButtons[i]);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Prepares all actions and listeners for game interactions.
&nbsp;     */
&nbsp;    public void prepareActions(){
<b class="nc">&nbsp;        setDefaultCloseOperation(JFrame.DO_NOTHING_ON_CLOSE);</b>
<b class="nc">&nbsp;        addWindowListener(new WindowAdapter() {</b>
&nbsp;            public void windowClosing(WindowEvent e) {
<b class="nc">&nbsp;                closeWindowAction();</b>
&nbsp;            }
&nbsp;        });
<b class="nc">&nbsp;        exit.addActionListener(e -&gt; closeWindowAction());</b>
<b class="nc">&nbsp;        newItem.addActionListener(e -&gt; openPrincipalWindow());</b>
<b class="nc">&nbsp;        int plantsLen = plantsButtons.length;</b>
<b class="nc">&nbsp;        for(int i = 0; i &lt; plantsLen; i++) {</b>
<b class="nc">&nbsp;            String plant = plantsToPlay[i];</b>
<b class="nc">&nbsp;            if (plantsButtons[i] != null) plantsButtons[i].addActionListener(e -&gt;selectPlant(plant));</b>
&nbsp;        }
<b class="nc">&nbsp;        for(int row = 0; row &lt; 5; row++) {</b>
<b class="nc">&nbsp;            for(int col = 0; col &lt; 10; col++) {</b>
<b class="nc">&nbsp;                int i = row;</b>
<b class="nc">&nbsp;                int j = col;</b>
<b class="nc">&nbsp;                if (cells[i][j] != null) cells[row][col].addActionListener(e -&gt; cellAction(i,j));</b>
&nbsp;            }
&nbsp;        }
<b class="nc">&nbsp;        shovelButton.addActionListener(e -&gt; canDelete());</b>
&nbsp;
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    /*
&nbsp;     * Adds a plant to the game board at the specified row and column.
&nbsp;     *
&nbsp;     * @param row The row index where the plant will be added.
&nbsp;     * @param col The column index where the plant will be added.
&nbsp;     */
&nbsp;    private void cellAction(int row, int col) {
&nbsp;        try {
<b class="nc">&nbsp;            if(pvz.isEmptyOfCoins(row,col) &amp;&amp; !shovelBoolean) {</b>
<b class="nc">&nbsp;                pvz.addPlant(row, col, selectedPlant);</b>
<b class="nc">&nbsp;                selectedPlant = null;</b>
<b class="nc">&nbsp;            } else if (shovelBoolean) {</b>
<b class="nc">&nbsp;                pvz.deletePlant(row,col);</b>
<b class="nc">&nbsp;                shovelBoolean = false;</b>
&nbsp;            } else {
&nbsp;
<b class="nc">&nbsp;                takeCoin(row,col);</b>
&nbsp;            }
&nbsp;        } catch (PVZException e) {
<b class="nc">&nbsp;            shovelBoolean = false;</b>
<b class="nc">&nbsp;            timerMessage(e.getMessage());</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Selects a plant to be placed on the game board.
&nbsp;     *
&nbsp;     * @param planta The name of the plant to be selected.
&nbsp;     */
&nbsp;    private void selectPlant(String planta){
<b class="nc">&nbsp;        selectedPlant = planta;</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Opens the main menu window and closes the current game window.
&nbsp;     */
&nbsp;    private void openPrincipalWindow() {
<b class="nc">&nbsp;        int opcion = JOptionPane.showConfirmDialog(this, &quot;Do you want to come to the start screen?&quot;, &quot;Confirm back&quot;, JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE);</b>
<b class="nc">&nbsp;        if (opcion == JOptionPane.YES_OPTION) {</b>
<b class="nc">&nbsp;            pvz.endGame();</b>
<b class="nc">&nbsp;            pvz = null;</b>
<b class="nc">&nbsp;            timer.stop();</b>
<b class="nc">&nbsp;            PVZGUI pvzguiwindow = new PVZGUI();</b>
<b class="nc">&nbsp;            pvzguiwindow.setVisible(true);</b>
<b class="nc">&nbsp;            dispose();</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Handles the action for closing the window. Prompts the user for confirmation.
&nbsp;     */
&nbsp;    private void closeWindowAction() {
<b class="nc">&nbsp;        int opcion = JOptionPane.showConfirmDialog(null, &quot;Are you sure that tou want to exit?&quot;, &quot;Confirm exit&quot;, JOptionPane.YES_NO_OPTION, JOptionPane.QUESTION_MESSAGE);</b>
<b class="nc">&nbsp;        if (opcion == JOptionPane.YES_NO_OPTION) {</b>
<b class="nc">&nbsp;            System.exit(0);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Take a coin of the board.
&nbsp;     */
&nbsp;    private void takeCoin(int row, int col) {
&nbsp;        try {
<b class="nc">&nbsp;            pvz.takeCoin(row, col);</b>
&nbsp;        } catch (PVZException e) {
<b class="nc">&nbsp;            throw new RuntimeException(e);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Make the shovel can delete.
&nbsp;     */
&nbsp;    private void canDelete() {
<b class="nc">&nbsp;        shovelBoolean = true;</b>
&nbsp;    }
&nbsp;
&nbsp;    /*
&nbsp;     * Refreshes the game panel by repainting it.
&nbsp;     */
&nbsp;    public void refresh() {
&nbsp;        try {
<b class="nc">&nbsp;            pvz.generateSun();</b>
<b class="nc">&nbsp;            pvz.makeShoot();</b>
<b class="nc">&nbsp;            pvz.makeDamage();</b>
<b class="nc">&nbsp;            pvz.moveBoard();</b>
<b class="nc">&nbsp;            pvz.garbageColector();</b>
<b class="nc">&nbsp;            pvz.zombieInLastCell();</b>
<b class="nc">&nbsp;            if(pvz.gameIsFinished()) finishGame();</b>
<b class="nc">&nbsp;            repaint();</b>
&nbsp;        } catch (PVZException e) {
<b class="nc">&nbsp;            timerMessage(e.getMessage());</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;
&nbsp;    /*
&nbsp;     * Show a temporal message in the screen.
&nbsp;     */
&nbsp;    private void timerMessage(String message) {
<b class="nc">&nbsp;        JDialog dialog = new JDialog();</b>
<b class="nc">&nbsp;        JLabel label = new JLabel(message);</b>
<b class="nc">&nbsp;        label.setBounds(20, 20, 70, 70);</b>
<b class="nc">&nbsp;        label.setFont(new Font(&quot;DialogInput&quot;, Font.BOLD, 10));</b>
<b class="nc">&nbsp;        dialog.setTitle(&quot;ERROR&quot;);</b>
<b class="nc">&nbsp;        dialog.add(label);</b>
<b class="nc">&nbsp;        dialog.setSize(300, 150);</b>
<b class="nc">&nbsp;        dialog.setLocationRelativeTo(null); // Centrar en la pantalla</b>
<b class="nc">&nbsp;        dialog.setDefaultCloseOperation(JDialog.DISPOSE_ON_CLOSE);</b>
<b class="nc">&nbsp;        dialog.setVisible(true);</b>
<b class="nc">&nbsp;        new Timer(1500, s -&gt; dialog.dispose()).start();</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    private void finishGame() {
&nbsp;        // Crear panel con las plantas que se van a jugar
<b class="nc">&nbsp;        ImageIcon icon = getImageIcon(&quot;fondoTablero.png&quot;);</b>
<b class="nc">&nbsp;        Image originalImage = icon.getImage();</b>
&nbsp;
&nbsp;        // Obtener puntos
<b class="nc">&nbsp;        int zombiePoints = pvz.getZombiePoints();</b>
<b class="nc">&nbsp;        int plantPoints = pvz.getPlantPoints();</b>
&nbsp;
&nbsp;        // Determinar el ganador
<b class="nc">&nbsp;        String ganador = &quot;&quot;;</b>
<b class="nc">&nbsp;        if (gameMode.equals(&quot;PvsP&quot;)) {</b>
<b class="nc">&nbsp;            ganador = zombiePoints &gt; plantPoints ? zombiePlayer : plantPlayer;</b>
<b class="nc">&nbsp;        } else if (gameMode.equals(&quot;PvsM&quot;)) {</b>
<b class="nc">&nbsp;            ganador = zombiePoints &gt; plantPoints ? zombieType : plantPlayer;</b>
<b class="nc">&nbsp;        } else if (gameMode.equals(&quot;MvsM&quot;)) {</b>
<b class="nc">&nbsp;            ganador = zombiePoints &gt; plantPoints ? zombieType : plantsType;</b>
&nbsp;        }
&nbsp;
&nbsp;        // Crear etiquetas
<b class="nc">&nbsp;        JLabel labelWinner = new JLabel(&quot;&lt;html&gt;&lt;span style=&#39;font-size:30px; color:white;&#39;&gt;¡Ganador!&lt;/span&gt;&lt;/html&gt;&quot;);</b>
<b class="nc">&nbsp;        JLabel label = new JLabel(&quot;&lt;html&gt;&lt;span style=&#39;font-size:30px; letter-spacing:20px; color:white;&#39;&gt;&quot; + ganador + &quot;&lt;/span&gt;&lt;/html&gt;&quot;);</b>
&nbsp;
&nbsp;        // Establecer posiciones
<b class="nc">&nbsp;        labelWinner.setBounds(gamePanel.getWidth() / 4, gamePanel.getHeight() / 2 - 100, 400, 100);</b>
<b class="nc">&nbsp;        label.setBounds(gamePanel.getWidth() / 4, gamePanel.getHeight() / 2, 400, 100);</b>
&nbsp;
&nbsp;        // Personalizar estilos
<b class="nc">&nbsp;        labelWinner.setHorizontalAlignment(SwingConstants.CENTER);</b>
<b class="nc">&nbsp;        label.setHorizontalAlignment(SwingConstants.CENTER);</b>
&nbsp;
&nbsp;        // Añadir las etiquetas al panel
<b class="nc">&nbsp;        gamePanel.add(labelWinner);</b>
<b class="nc">&nbsp;        gamePanel.add(label);</b>
&nbsp;
&nbsp;        // Finalizar el juego
<b class="nc">&nbsp;        if (gameMode.equals(&quot;PvsM&quot;))pvz.endGame();</b>
<b class="nc">&nbsp;        if (gameMode.equals(&quot;MvsM&quot;))pvz.endGameTwo();</b>
<b class="nc">&nbsp;        timer.stop();</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    public static PVZInGame open(File file) {
<b class="nc">&nbsp;       PVZInGame game = null;</b>
<b class="nc">&nbsp;        try (FileInputStream fileIn = new FileInputStream(file);</b>
<b class="nc">&nbsp;             ObjectInputStream in = new ObjectInputStream(fileIn)) {</b>
<b class="nc">&nbsp;            game = (PVZInGame) in.readObject();</b>
&nbsp;        }catch(IOException | ClassNotFoundException e){
<b class="nc">&nbsp;            e.printStackTrace();</b>
&nbsp;        }
<b class="nc">&nbsp;        return game;</b>
&nbsp;    }
&nbsp;    public void setPvz(PVZ pvz) {
<b class="nc">&nbsp;        pvz = pvz;</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2024-12-16 16:10</div>
</div>
</body>
</html>
